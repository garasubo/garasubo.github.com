---
title: "Rustで組込みプログラミングや自作OS作成をするには"
pubDate: "2020-05-06"
tags: ["rust", "kernel/vm", "osdev"]
description: "Rustで組込みプログラムや自作OSを作成するためのガイドとリソース"
---
    - osdev
---

「Rustで始める自作組込みOS入門」という本というかドキュメントの公開を始めました。

{% linkPreview https://garasubo.github.io/embedded-book/index.html _blank %}

これは以前からつくっていた[ErkOS](/hexo/2019/05/15/erkos.html)という自作OSでの経験を元にして、どうやったらRustで自作組込みOSの最初の一歩を踏み出せるか、というものをドキュメントにしたものです。
このドキュメントはこの前の技術書展の告知が来たあたりから構想を練っていて、すきま時間にちまちまと書き進めていたものですが、とりあえず、プロセスの切り替えっぽいところまでの説明を終えることができたので公開しました。

組込みでRustをやる話や自作OSを書く話というのは先駆者がたくさんいて、僕自身もそれらの資料を参考にしつつ書き進めて来ました。
一応、それらの既存のものとは差別化はしているつもりではあるものの、既存のものを完全に上回るというものではないです。内容もまだまだ足りない。

以前、[RustでOSを書くプロジェクトもろもろ](/hexo/2017/11/05/rust-os.html)でいくつかOSを書く際に参考になりそうなプロジェクトをまとめましたが、情報も古くなってきたので、改めて参考になるプロジェクトを紹介していきたいと思います。

## Redox
{% linkPreview https://www.redox-os.org/jp/ _blank %}
RustでデスクトップOSを書くというプロジェクト。完成度はかなり高く、GUIツールなどもすべてRustで書き直す、とかなり本格的。
[最近のブログポスト](https://www.redox-os.org/jp/news/focusing-on-rustc/)によると実際のハードウェアで動くための課題はかなりクリアできているようで、
今はコンパイラそのものを改良してRedox上でRedoxをビルドすることを目指しているらしい。

このRedoxプロジェクトから派生したクレートも役に立つものが多い

## Tock
{% linkPreview https://www.tockos.org/ _blank %}
Rustで書かれたCortex-M向けの組込みOS。SOSPで[論文](/hexo/2018/05/23/tock.html)を出していいたりとOSそのもの構造も興味深い。
かつてはRustコンパイラに手を加えたりするものが主流でしたが、このTockはnightlyコンパイラだけでコンパイルできるのも特徴。

最近、Googleが発表した[OpenSK](https://github.com/google/OpenSK)というUSBのセキュリティキーのオープンな実装を発表したが、そこで使われているのもこのTockです。

## Rust Embeddedグループ
{% linkPreview https://github.com/rust-embedded/wg _blank %}
Rustにはいくつかの公式ワーキンググループがあって、そのうちの１つがこのEmbeddedワーキンググループです。
各種ドキュメントや組込み開発で使えるクレートを公開しています。
主にCortex-MやCortex-A、RISC-Vをターゲットにしています。

[The Embedonomicon](https://docs.rust-embedded.org/embedonomicon/)は一からベアメタルプログラミングするための手引になっていてとても参考になります。

[RaspberryPiを使ったOS開発のチュートリアル](https://github.com/rust-embedded/rust-raspberrypi-OS-tutorials)はGICv2にも対応しているようなので、Cortex-Aで自作OSしたい人は参考になるかもしれません。

OS開発ということにフォーカスしているわけではないですが、個々のコンポーネントを書く際はかなり参考になります。

## Rust OSDev
{% linkPreview https://github.com/rust-osdev _blank %}
非公式グループですが、OSを書く、ということに焦点を置いたグループです。
こちらはx86系のアーキテクチャをたーゲットにしています。

UEFIのアプリケーションを書くのに便利な[uefiクレート](https://github.com/rust-osdev/uefi-rs)など、x86系の自作OSに役立つクレートを多く出しています。

特にこのグループのメンバーの一人であるPhilippさんの自作OSブログは内容が充実していて、自作OSでのテストの書き方やヒープアロケータのデザインと実装といった他のアーキテクチャでも使える項目の解説も充実しています。
{% linkPreview https://os.phil-opp.com/ _blank %}

## 日本語の資料
今まで紹介したものはほとんどが英語のものでしたが、日本語のリソースとして[@LDScell](https://twitter.com/LDScell)さんがEmbeddedグループのドキュメントの和訳を公開している他、
「組込み/ベアメタルRustクックブック」という資料を公開しています。
{% linkPreview https://booth.pm/ja/items/1478032 _blank %}
